# Goal

社内向け会議室予約Webアプリ「RoomFlow」を構築する。
会議室ごとの空き枠確認、予約作成、予約変更、予約キャンセルを提供し、予約競合を確実に防止する。

## Background

会議室の予約がチャットや口頭で管理されており、ダブルブッキングや利用状況の可視性不足が発生しています。
最低限の運用で破綻しない予約基盤を先に整備したいです。

## Constraints

- Monorepo (pnpm workspaces) を維持する
- Backend: Hono
- Frontend: React + Tailwind CSS
- Database: PostgreSQL + Drizzle ORM
- 技術構成は上記から変更しない

## Acceptance Criteria

- [ ] 会議室一覧が表示される（名称、収容人数、設備）
- [ ] 日付と会議室を指定して空き枠を確認できる
- [ ] 予約を作成できる（会議名、開始時刻、終了時刻、予約者名）
- [ ] 既存予約の変更ができる
- [ ] 予約のキャンセルができる（誤操作防止の確認あり）
- [ ] 同一会議室・同一時間帯の重複予約はAPIで拒否される
- [ ] 一覧画面で会議室と日付による絞り込みができる
- [ ] 必須項目未入力時は、API/画面の双方でバリデーションエラーを返す
- [ ] APIエラー時にユーザーが原因を把握できるメッセージを表示する
- [ ] クリティカルパス（空き枠確認→予約作成→重複予約拒否→予約変更→予約キャンセル）のE2Eテストがある
- [ ] Vitest による単体テストと結合テストがある

## Scope

## In Scope

- 会議室・予約のDBスキーマ定義
- APIの実装
- フロントエンドの実装
- バリデーション実装（API/フロントの両方）
- 予約競合防止の整合性実装
- テスト実装（E2E、Vitest単体、Vitest結合）

## Out of Scope

- ユーザー認証・認可
- 外部カレンダー連携（Google Calendar等）
- 通知機能（メール、Slack）
- リアルタイム同期

## Allowed Paths

- packages/db/\*\*
- apps/api/\*\*
- apps/web/\*\*

## Risk Assessment

- API と UI のバリデーション不整合
- 同時更新時の予約競合処理漏れ
- テストの不安定化（タイミング依存）

## Notes

モダンなUIで実装してください。
実装は最小構成でよいですが、テストしやすい設計（責務分離）を意識してください。
予約競合の制御はDBレベルとAPIレベルの両方で安全策を検討してください。
